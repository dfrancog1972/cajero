<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=no, initial-scale=1.0, maximum-scale=1.0, maximum-scale=1.0">
    <title>Proyecto Cajero Automatico</title>    
    <title>Principal</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    
</head>
<body>
    <!--Formulario para autenticar el acceso a las cuentas-->
    <header>
        <h1>Acceso a tu cuenta Bancaria</h1>
    </header>
    <main>
        <form action="">
            <div class="row">
                <div class="row">
                    <div class="col-xs-12 col-sm-12 col-md-3"> 
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-3"> 
                        <label for="" class="h3">Usuario</label>
                        <input type="text" name="u" id="">
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-3"> 
                        <label for="" class="h3">password</label>
                        <input type="password" name="c" id="">
                        <!--se invoca a la funcion login y se le pasa los parametros del form-->
                        <input type="button" value="Ingresar" onclick="login(this.form)">
                    </div>
            </div>
            
        </form>    
    </main>
    <!--scrip de js para validar usuario y contrase単a, solo de forma interna, es decir no hace consulta a una bd-->
    <!-- se verifican los parametros de los name u y c que corresponden al usuario y contrase単a del form-->
    <!-- esta parte se puede mejorar si la informacion se consulta de una bd-->
    <script>        
        function login(form){
            var cuentas=[
                {nombre:"Mali", saldo:200, clave:1234},
                {nombre:"Gera", saldo:290, clave:4321},
                {nombre:"Maui", saldo:67, clave:3412}
            ];
            // for(indice in cuentas){ 
            //     console.log(indice);
            //     if(form.u.value==cuentas[indice].nombre){
            //         if(form.c.value==cuentas[indice].clave){
            //             location="menuprincipal.html";
            //         }else{
            //             alert("error de contrase単a")
            //         }
            //     }else{
            //         alert("error de usuario");
            //     }            
            // }

            //uso una funcion de js para la busqueda del elemento en el arreglo
            //la busqueda la hago con logica negativa si no encuentro el usuario mando la alerta

            var cuenta = cuentas.find(element => element.nombre == form.u.value)
            if (cuenta == undefined){
                alert('No se encuentra el usuario');
                return;
            }

            // si se encuentra el usuario se compara la clave si no se encuentra se manda la alerta
            // con esto evito el tener if anidados
            if(form.c.value!=cuenta.clave){
                alert('Contrase単a Incorrecta');
                return;                
            }

            // si nada falla se abre la pagina de operaciones
            //guardo los elementos de los usuarios en un objeto para leerlo en la otra pagina
            localStorage.clear();
            localStorage.setItem("userdata", JSON.stringify(cuenta));
            location="menuprincipal.html";


        }
    </script>
    
</body>
</html>